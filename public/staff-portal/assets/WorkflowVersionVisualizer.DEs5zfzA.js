import{ao as I,b7 as m,dN as C,dO as h,bT as u,bW as S,dP as V,r as E,i as w,dQ as T,p as k,j as s,dR as R,ap as b,a as y,dS as F,dT as N,ad as O,n as D,dU as P,dV as v}from"./index.Dg3lKJeg.js";import{C as d,S as _,b as x,c as z}from"./WorkflowDiagramStepNodeIcon.CqIy9G-o.js";import{u as M,g as B,W as X}from"./getWorkflowVersionStatusTagProps.D_ayypKq.js";import{a as A,g as p,B as W,E as L,R as j}from"./style.BQlYoUOS.js";import{W as G}from"./WorkflowDiagramStepNodeReadonly.DDcoJTVF.js";import"./index.C2saR20x.js";import"./string.DY8YL-MQ.js";const K=()=>{const{getIcon:e}=I(),o=m(C),{openWorkflowViewStepInCommandMenu:t}=h(),n=u(S),r=u(V),a=E.useCallback(({nodes:f})=>{if(!(w(n)&&w(r)))return;const l=f[0];if(!w(l))return;o(l.id);const i=l.data;t({workflowId:n,workflowVersionId:r,title:i.name,icon:e(T(i))})},[o,t,n,r,e]);return A({onChange:a}),M(),null},q=({sourceY:e,targetY:o,markerStart:t,markerEnd:n})=>{const r=k(),[a]=p({sourceX:d,sourceY:e,targetX:d,targetY:o});return s(W,{markerStart:t,markerEnd:n,path:a,style:{stroke:r.border.color.strong}})},U=()=>{const{getIcon:e}=I(),o=u(S),t=u(V),{openWorkflowViewStepInCommandMenu:n}=h(),r=m(C),a=m(R);return{openWorkflowViewFilterInCommandMenu:({stepId:l,stepName:i})=>{if(!o)throw new Error("Workflow ID is required");if(!t)throw new Error("Workflow version ID is required");r(l),a(c=>{if(!w(c))throw new Error("Workflow diagram must be defined");return{...c,nodes:c.nodes.map(g=>({...g,selected:!1}))}}),n({workflowId:o,workflowVersionId:t,title:i,icon:e(b("FILTER"))})}}},H=e=>{if((e==null?void 0:e.edgeType)!=="filter")throw new Error('Edge data must be of type "filter"')},Q=D(P)`
  pointer-events: all;
`,Y=D.div`
  height: 26px;
  width: 26px;
`,$=({sourceY:e,targetY:o,markerStart:t,markerEnd:n,data:r})=>{H(r);const a=k(),[f,l,i]=p({sourceX:d,sourceY:e,targetX:d,targetY:o}),{openWorkflowViewFilterInCommandMenu:c}=U(),g=()=>{c({stepId:r.stepId,stepName:r.name})};return y(O,{children:[s(W,{markerStart:t,markerEnd:n,path:f,style:{stroke:a.border.color.strong}}),s(L,{children:s(_,{"data-click-outside-id":F,labelX:l,labelY:i,children:s(x,{shouldDisplay:!0,children:s(Y,{children:s(Q,{className:"nodrag nopan",iconButtons:[{Icon:N,onClick:g}]})})})})})]})},J=({markerStart:e,markerEnd:o,sourceY:t,targetY:n})=>{const r=k(),[a]=p({sourceX:d,sourceY:t,targetX:d,targetY:n});return s(W,{markerStart:e,markerEnd:o,path:a,style:{stroke:r.border.color.strong}})},Z=({versionStatus:e})=>{const o=B({workflowVersionStatus:e});return y(j,{children:[s(z,{nodeTypes:{default:G,"empty-trigger":X},edgeTypes:{"filtering-disabled--readonly":J,"empty-filter--readonly":q,"filter--readonly":$},tagContainerTestId:"workflow-visualizer-status",tagColor:o.color,tagText:o.text}),s(K,{})]})},le=({workflowVersionId:e})=>{const o=v(e);return w(o)?s(Z,{versionStatus:o.status}):null};export{le as WorkflowVersionVisualizer};
