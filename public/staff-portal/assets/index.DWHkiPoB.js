import{z as x}from"./index.C2o2j-tx.js";import{f as m,a as y,e as k,p as B,h as F}from"./index.DOWyBKr8.js";import{d as L}from"./index.dom.C3-224fz.js";import"./index.ByI_odx6.js";import"./index.Wb4bzIyB.js";import"./index.BVeNH5zi.js";import"./index.COYepv-L.js";const S={}.hasOwnProperty;function A(e,n){let r=-1,t;if(n.extensions)for(;++r<n.extensions.length;)A(e,n.extensions[r]);for(t in n)if(S.call(n,t))switch(t){case"extensions":break;case"unsafe":{w(e[t],n[t]);break}case"join":{w(e[t],n[t]);break}case"handlers":{j(e[t],n[t]);break}default:e.options[t]=n[t]}return e}function w(e,n){n&&e.push(...n)}function j(e,n){n&&Object.assign(e,n)}const _=[I];function I(e,n,r,t){if(n.type==="code"&&m(n,t)&&(e.type==="list"||e.type===n.type&&m(e,t)))return!1;if("spread"in r&&typeof r.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&y(n,t))?void 0:r.spread?1:0}const C=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],v=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:C},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:C},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:C},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:C},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:C},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:C},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:C},{atBreak:!0,character:"~"}];function T(e,n){const r=Number.parseInt(e,n);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"ï¿½":String.fromCodePoint(r)}const G=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function P(e){return e.replace(G,R)}function R(e,n,r){if(n)return n;if(r.charCodeAt(0)===35){const a=r.charCodeAt(1),c=a===120||a===88;return T(r.slice(c?2:1),c?16:10)}return L(r)||e}function E(e){return e.label||!e.identifier?e.label||"":P(e.identifier)}function M(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function z(e,n,r){const t=n.indexStack,a=e.children||[],c=[];let o=-1,i=r.before,u;t.push(-1);let h=n.createTracker(r);for(;++o<a.length;){const s=a[o];let f;if(t[t.length-1]=o,o+1<a.length){let d=n.handle.handlers[a[o+1].type];d&&d.peek&&(d=d.peek),f=d?d(a[o+1],e,n,{before:"",after:"",...h.current()}).charAt(0):""}else f=r.after;c.length>0&&(i==="\r"||i===`
`)&&s.type==="html"&&(c[c.length-1]=c[c.length-1].replace(/(\r?\n|\r)$/," "),i=" ",h=n.createTracker(r),h.move(c.join("")));let l=n.handle(s,e,n,{...h.current(),after:f,before:i});u&&u===l.slice(0,1)&&(l=k(u.charCodeAt(0))+l.slice(1));const p=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,u=void 0,p&&(c.length>0&&p.before&&i===c[c.length-1].slice(-1)&&(c[c.length-1]=c[c.length-1].slice(0,-1)+k(i.charCodeAt(0))),p.after&&(u=f)),h.move(l),c.push(l),i=l.slice(-1)}return t.pop(),c.join("")}function D(e,n,r){const t=n.indexStack,a=e.children||[],c=n.createTracker(r),o=[];let i=-1;for(t.push(-1);++i<a.length;){const u=a[i];t[t.length-1]=i,o.push(c.move(n.handle(u,e,n,{before:`
`,after:`
`,...c.current()}))),u.type!=="list"&&(n.bulletLastUsed=void 0),i<a.length-1&&o.push(c.move(N(u,a[i+1],e,n)))}return t.pop(),o.join("")}function N(e,n,r,t){let a=t.join.length;for(;a--;){const c=t.join[a](e,n,r,t);if(c===!0||c===1)break;if(typeof c=="number")return`
`.repeat(1+c);if(c===!1)return`

<!---->

`}return`

`}const O=/\r?\n|\r/g;function Z(e,n){const r=[];let t=0,a=0,c;for(;c=O.exec(e);)o(e.slice(t,c.index)),r.push(c[0]),t=c.index+c[0].length,a++;return o(e.slice(t)),r.join("");function o(i){r.push(n(i,a,!i))}}function Q(e,n,r){const t=(r.before||"")+(n||"")+(r.after||""),a=[],c=[],o={};let i=-1;for(;++i<e.unsafe.length;){const s=e.unsafe[i];if(!B(e.stack,s))continue;const f=e.compilePattern(s);let l;for(;l=f.exec(t);){const p="before"in s||!!s.atBreak,d="after"in s,g=l.index+(p?l[1].length:0);a.includes(g)?(o[g].before&&!p&&(o[g].before=!1),o[g].after&&!d&&(o[g].after=!1)):(a.push(g),o[g]={before:p,after:d})}}a.sort(H);let u=r.before?r.before.length:0;const h=t.length-(r.after?r.after.length:0);for(i=-1;++i<a.length;){const s=a[i];s<u||s>=h||s+1<h&&a[i+1]===s+1&&o[s].after&&!o[s+1].before&&!o[s+1].after||a[i-1]===s-1&&o[s].before&&!o[s-1].before&&!o[s-1].after||(u!==s&&c.push(b(t.slice(u,s),"\\")),u=s,/[!-/:-@[-`{-~]/.test(t.charAt(s))&&(!r.encode||!r.encode.includes(t.charAt(s)))?c.push("\\"):(c.push(k(t.charCodeAt(s))),u++))}return c.push(b(t.slice(u,h),r.after)),c.join("")}function H(e,n){return e-n}function b(e,n){const r=/\\(?=[!-/:-@[-`{-~])/g,t=[],a=[],c=e+n;let o=-1,i=0,u;for(;u=r.exec(c);)t.push(u.index);for(;++o<t.length;)i!==t[o]&&a.push(e.slice(i,t[o])),a.push("\\"),i=t[o];return a.push(e.slice(i)),a.join("")}function U(e){const n=e||{},r=n.now||{};let t=n.lineShift||0,a=r.line||1,c=r.column||1;return{move:u,current:o,shift:i};function o(){return{now:{line:a,column:c},lineShift:t}}function i(h){t+=h}function u(h){const s=h||"",f=s.split(/\r?\n|\r/g),l=f[f.length-1];return a+=f.length-1,c=f.length===1?c+l.length:1+l.length+t,s}}function q(e,n){const r=n||{},t={associationId:E,containerPhrasing:W,containerFlow:X,createTracker:U,compilePattern:M,enter:c,handlers:{...F},handle:void 0,indentLines:Z,indexStack:[],join:[..._],options:{},safe:Y,stack:[],unsafe:[...v]};A(t,r),t.options.tightDefinitions&&t.join.push(V),t.handle=x("type",{invalid:J,unknown:K,handlers:t.handlers});let a=t.handle(e,void 0,t,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function c(o){return t.stack.push(o),i;function i(){t.stack.pop()}}}function J(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function K(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function V(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function W(e,n){return z(e,this,n)}function X(e,n){return D(e,this,n)}function Y(e,n){return Q(this,e,n)}function oe(e){const n=this;n.compiler=r;function r(t){return q(t,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}export{oe as default};
