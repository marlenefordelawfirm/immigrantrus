import{af as e,o as U,a5 as P,N as v,T as w,b2 as B,a6 as k,a7 as H,a8 as V,a9 as W,r as m,b3 as F,aJ as M,b4 as _,aa as X,j as t,a as d,z as p,l as S,H as u,B as c,Q as q,ai as x}from"./index.Dg3lKJeg.js";import{u as Y}from"./SettingsDataModelFieldPreviewCard.C61YjwJF.js";import{S as G}from"./SaveAndCancelButtons.DdB8J98L.js";import{S as J}from"./SettingsPageContainer.CJeLyK8s.js";import{S as K}from"./SettingsObjectNewFieldSelect.DyonPEDi.js";import{s as Q,S as $,F as z,a as Z,b as ee}from"./settingsFieldFormSchema.CCxvyFAT.js";import{S as ae}from"./SubMenuTopBarContainer.BNGFwgBo.js";import"./mutations.DtsxS3kK.js";import"./DatabaseIdentifierMaximumLength.CM85nVoY.js";import"./workspaceMemberQueryFragment.BaSCE7Jb.js";import"./SettingsFieldTypeConfigs.DAFrDVaZ.js";import"./SettingsNonCompositeFieldTypeConfigs.CqgeJGaG.js";import"./getObjectTypeLabel.CC2ZWRUI.js";import"./IconDeviceFloppy.CaehffdS.js";import"./SettingsCard.EuecTdsf.js";import"./index.DYjQm0RB.js";import"./SettingsOptionCardContentToggle.DYPf28jM.js";import"./SettingsOptionIconCustomizer.BYkiWDDL.js";import"./SettingsOptionCardContentSelect.DFB7abf9.js";import"./IconTextWrap.Ct51CuzD.js";import"./Breadcrumb.CQyf5Hn6.js";const N={[e.ADDRESS]:"IconMap",[e.BOOLEAN]:"IconToggleLeft",[e.CURRENCY]:"IconMoneybag",[e.DATE]:"IconCalendarEvent",[e.DATE_TIME]:"IconCalendarClock",[e.FULL_NAME]:"IconUserCircle",[e.MULTI_SELECT]:"IconTags",[e.NUMBER]:"IconNumber9",[e.RATING]:"IconStar",[e.RAW_JSON]:"IconBraces",[e.RELATION]:"IconRelationOneToMany",[e.MORPH_RELATION]:"IconRelationOneToMany",[e.SELECT]:"IconTag",[e.TEXT]:"IconTypography",[e.UUID]:"IconId",[e.ARRAY]:"IconBracketsContain",[e.EMAILS]:"IconMail",[e.LINKS]:"IconWorld",[e.PHONES]:"IconPhone",[e.ACTOR]:"IconUsers",[e.NUMERIC]:"IconUsers",[e.POSITION]:"IconUsers",[e.RICH_TEXT]:"IconUsers",[e.RICH_TEXT_V2]:"IconUsers",[e.TS_VECTOR]:"IconUsers"},h="IconUsers",Ne=()=>{const{i18n:o,_:te}=U(),T=P(),g=v(),{objectNamePlural:l=""}=w(),[A]=B(),s=A.get("fieldType")||e.TEXT,{enqueueErrorSnackBar:C}=k(),{findActiveObjectMetadataItemByNamePlural:O}=H(),a=O(l),{createMetadataField:E}=Y(),i=V({mode:"onTouched",resolver:W(Q(a==null?void 0:a.fields.map(r=>r.name))),defaultValues:{type:s,icon:N[s]??h,label:"",description:"",name:""}});m.useEffect(()=>{i.setValue("icon",N[s]??h)},[s,i]);const[L,I]=m.useState(!1);F({objectNameSingular:M.View,filter:{type:{eq:_.Table},objectMetadataId:{eq:a==null?void 0:a.id}}});const b=i.watch("relation.objectMetadataId");if(F({objectNameSingular:M.View,skip:!b,filter:{type:{eq:_.Table},objectMetadataId:{eq:b}}}),m.useEffect(()=>{a||T(X.NotFound)},[a,T]),!a)return null;const{isValid:y,isSubmitting:f}=i.formState,D=y&&!f,R=async r=>{try{if(I(!0),r.type===e.RELATION&&"relation"in r){const{relation:n,...j}=r;await E({...j,objectMetadataId:a.id,relationCreationPayload:{type:n.type,targetObjectMetadataId:n.objectMetadataId,targetFieldLabel:n.field.label,targetFieldIcon:n.field.icon}})}else await E({...r,objectMetadataId:a.id});g(c.ObjectDetail,{objectNamePlural:l}),I(!1)}catch(n){I(!1),C({apolloError:n instanceof x?n:void 0})}};return a?t(q,{...i,children:t(ae,{title:o._({id:"0HAF12"}),links:[{children:o._({id:"pmUArF"}),href:p(c.Workspace)},{children:o._({id:"B3toQF"}),href:p(c.Objects)},{children:a.labelPlural,href:p(c.ObjectDetail,{objectNamePlural:l})},{children:t(K,{})}],actionButton:t(G,{isLoading:L,isSaveDisabled:!D,isCancelDisabled:f,onCancel:()=>g(c.ObjectNewFieldSelect,{objectNamePlural:l},{fieldType:s}),onSave:i.handleSubmit(R)}),children:d(J,{children:[d(S,{children:[t(u,{title:o._({id:"XTWO+W"}),description:o._({id:"h8mvCd"})}),t($,{maxLength:z,isCreationMode:!0})]}),d(S,{children:[t(u,{title:o._({id:"fXVIZq"}),description:o._({id:"uWikAA"})}),t(Z,{fieldMetadataItem:{icon:i.watch("icon"),label:i.watch("label")||"New Field",settings:i.watch("settings")||null,type:s},objectMetadataItem:a})]}),d(S,{children:[t(u,{title:o._({id:"Nu4oKW"}),description:o._({id:"2OUtmv"})}),t(ee,{})]})]})})}):null};export{Ne as SettingsObjectNewFieldConfigure};
