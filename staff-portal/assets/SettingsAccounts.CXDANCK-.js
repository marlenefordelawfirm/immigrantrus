import{p as P,j as t,aE as ee,aD as te,o as T,a8 as oe,a9 as ne,a2 as F,r as ie,a as d,a4 as se,_ as re,ae as K,fr as ce,n as m,a$ as de,f9 as ae,fs as le,d0 as me,df as _e,h as E,ad as M,R as Z,cw as W,b3 as X,aJ as S,i as R,ft as Ie,cZ as Ne,H as v,l as D,Z as y,bv as Ae,N as Q,eH as ue,fu as ge,fv as Ee,dA as Se,dB as Te,C as L,eJ as h,A as G,B as u,d1 as f,em as $,cd as he,bx as pe,d9 as fe,eK as Ce,dz as De,by as Oe,a0 as O,y as Re,x as Le,bn as be,z as k,E as z,aw as Pe,fw as xe,fx as we}from"./index.Dg3lKJeg.js";import{S as C,T as x}from"./TableRow.BM7bNp8J.js";import{S as B}from"./Table.6yesK_WS.js";import{S as Fe}from"./TableBody.DCdzfPFn.js";import{S as b}from"./TableHeader.D43eMMOy.js";import{S as ye}from"./SettingsAccountsListEmptyStateCard.C5yZXEkx.js";import{a as p}from"./MessageChannel.DsViokZd.js";import{I as Ge}from"./IconSend.DC3MhWFv.js";import{S as j}from"./SettingsCard.EuecTdsf.js";import{I as ke}from"./IconMailCog.D1zKcq18.js";import{S as Me}from"./SettingsPageContainer.CJeLyK8s.js";import{S as ve}from"./SubMenuTopBarContainer.BNGFwgBo.js";import"./Breadcrumb.CQyf5Hn6.js";const $e=()=>{const e=P();return t(te,{baseColor:e.background.tertiary,highlightColor:e.background.transparent.lighter,borderRadius:4,children:t(ee,{height:20,width:512})})},Be=m.div`
  display: flex;
  flex-direction: row;
`,Ve=m.div`
  flex: 1;
  margin-right: ${({theme:e})=>e.spacing(2)};
`,ze=({updateBlockedEmailList:e,blockedEmailOrDomainList:n})=>{const{i18n:o,_:r}=T(),i=N=>F.object({emailOrDomain:F.string().trim().email(o._({id:"/m52AE"})).or(F.string().refine(g=>g.startsWith("@")&&ce(g.slice(1),{allowIp:!1,allowLocalhost:!1}),o._({id:"/m52AE"}))).refine(g=>!N.includes(g),o._({id:"QT/Wo7"}))}).required(),{reset:c,handleSubmit:s,control:_,formState:I}=oe({mode:"onSubmit",resolver:ne(i(n)),defaultValues:{emailOrDomain:""}}),a=s(N=>{e(N.emailOrDomain)}),J=N=>{N.key===de.Key.Enter&&a()},{isSubmitSuccessful:V}=I;return ie.useEffect(()=>{V&&c()},[V,c]),t("form",{onSubmit:a,children:d(Be,{children:[t(Ve,{children:t(se,{name:"emailOrDomain",control:_,render:({field:{value:N,onChange:g},fieldState:{error:w}})=>t(re,{instanceId:"settings-accounts-blocklist-input",placeholder:"eddy@gmail.com, @apple.com",value:N,onChange:g,error:w==null?void 0:w.message,onKeyDown:J,fullWidth:!0})})}),t(K,{title:o._({id:"5+ttxv"}),type:"submit"})]})})},je=({blocklistItem:e,onRemove:n})=>d(x,{gridAutoColumns:"200px 1fr 20px",mobileGridAutoColumns:"120px 1fr 20px",children:[t(C,{children:t(ae,{text:e.handle})}),t(C,{children:e.createdAt?le(e.createdAt):""}),t(C,{align:"right",children:t(me,{onClick:()=>{n(e.id)},variant:"tertiary",size:"small",Icon:_e})})]},e.id),Ye=m(B)`
  margin-top: ${({theme:e})=>e.spacing(4)};
`,He=m(Fe)`
  border-bottom: 1px solid ${({theme:e})=>e.border.color.light};
`,Ue=({blocklist:e,handleBlockedEmailRemove:n})=>t(M,{children:e.length>0&&d(Ye,{children:[d(x,{gridAutoColumns:"200px 1fr 20px",mobileGridAutoColumns:"120px 1fr 20px",children:[t(b,{children:E._({id:"VI2hiF"})}),t(b,{children:E._({id:"9iIYOy"})}),t(b,{})]}),t(He,{children:e.map(o=>t(je,{blocklistItem:o,onRemove:n},o.id))})]})}),qe=()=>{const{i18n:e,_:n}=T(),o=Z(W),r=(o==null?void 0:o.id)??"",{records:i}=X({objectNameSingular:S.Blocklist,filter:{workspaceMemberId:{in:[r]}},skip:!R(o)}),{createOneRecord:c}=Ie({objectNameSingular:S.Blocklist}),{deleteOneRecord:s}=Ne({objectNameSingular:S.Blocklist}),_=a=>{s(a)},I=a=>{c({handle:a,workspaceMemberId:o==null?void 0:o.id})};return d(D,{children:[t(v,{title:e._({id:"K1172m"}),description:e._({id:"yhhfqh"})}),t(ze,{blockedEmailOrDomainList:i.map(a=>a.handle),updateBlockedEmailList:I}),t(Ue,{blocklist:i,handleBlockedEmailRemove:_})]})},Y=m(b)`
  padding-right: ${({theme:e})=>e.spacing(14)};
`,Ke=()=>t(B,{children:d(x,{gridAutoColumns:"332px 1fr",children:[t(Y,{children:t(y,{id:"AeXO77"})}),t(Y,{align:"right",children:t(y,{id:"uAQUqI"})})]})}),H="delete-account-modal",Ze=({account:e})=>{const n=`settings-account-row-${e.id}`,{i18n:o,_:r}=T(),{openModal:i}=Ae(),c=Q(),{closeDropdown:s}=ue(),{destroyOneRecord:_}=ge({objectNameSingular:S.ConnectedAccount}),{triggerProviderReconnect:I}=Ee(),a=async()=>{await _(e.id)};return d(M,{children:[t(De,{dropdownId:n,dropdownPlacement:"right-start",clickableComponent:t(fe,{Icon:Ce,accent:"tertiary"}),dropdownComponents:t(Se,{children:d(Te,{children:[e.provider===L.IMAP_SMTP_CALDAV&&t(h,{text:o._({id:"W4Kgwq"}),LeftIcon:G,onClick:()=>{c(u.EditImapSmtpCaldavConnection,{connectedAccountId:e.id}),s(n)}}),t(h,{LeftIcon:f,text:o._({id:"Ww/M6X"}),onClick:()=>{c(u.AccountsEmails),s(n)}}),t(h,{LeftIcon:$,text:o._({id:"wLtx+m"}),onClick:()=>{c(u.AccountsCalendars),s(n)}}),e.authFailedAt&&t(h,{LeftIcon:he,text:o._({id:"gcoiFh"}),onClick:()=>{I(e.provider,e.id),s(n)}}),t(h,{accent:"danger",LeftIcon:pe,text:o._({id:"1O32oy"}),onClick:()=>{s(n),i(H)}})]})})}),t(Oe,{modalId:H,title:o._({id:"TtG/MN"}),subtitle:t(y,{id:"7EZqN0"}),onConfirmClick:a,confirmButtonText:o._({id:"ZDGm40"})})]})};var l;(function(e){e.SYNCED="SYNCED",e.FAILED="FAILED",e.NOT_SYNCED="NOT_SYNCED",e.IMPORTING="IMPORTING"})(l||(l={}));var A;(function(e){e.NOT_SYNCED="NOT_SYNCED",e.ONGOING="ONGOING",e.ACTIVE="ACTIVE",e.FAILED_INSUFFICIENT_PERMISSIONS="FAILED_INSUFFICIENT_PERMISSIONS",e.FAILED_UNKNOWN="FAILED_UNKNOWN"})(A||(A={}));var U;(function(e){e.FULL_CALENDAR_EVENT_LIST_FETCH_PENDING="FULL_CALENDAR_EVENT_LIST_FETCH_PENDING",e.PARTIAL_CALENDAR_EVENT_LIST_FETCH_PENDING="PARTIAL_CALENDAR_EVENT_LIST_FETCH_PENDING",e.CALENDAR_EVENT_LIST_FETCH_ONGOING="CALENDAR_EVENT_LIST_FETCH_ONGOING",e.CALENDAR_EVENTS_IMPORT_PENDING="CALENDAR_EVENTS_IMPORT_PENDING",e.CALENDAR_EVENTS_IMPORT_ONGOING="CALENDAR_EVENTS_IMPORT_ONGOING",e.FAILED="FAILED"})(U||(U={}));var q;(function(e){e.AS_PARTICIPANT_AND_ORGANIZER="AS_PARTICIPANT_AND_ORGANIZER",e.AS_PARTICIPANT="AS_PARTICIPANT",e.AS_ORGANIZER="AS_ORGANIZER",e.NONE="NONE"})(q||(q={}));const We=(e,n)=>e===p.FAILED_UNKNOWN||e===p.FAILED_INSUFFICIENT_PERMISSIONS||n===A.FAILED_UNKNOWN||n===A.FAILED_INSUFFICIENT_PERMISSIONS?l.FAILED:e===p.ONGOING||n===A.ONGOING?l.IMPORTING:e===p.NOT_SYNCED&&n===A.NOT_SYNCED?l.NOT_SYNCED:e===p.ACTIVE||n===A.ACTIVE?l.SYNCED:l.NOT_SYNCED,Xe=m.div`
  align-items: center;
  display: flex;
  gap: ${({theme:e})=>e.spacing(4)};
`,Qe=({account:e})=>{var i,c;const n=(i=e.messageChannels[0])==null?void 0:i.syncStatus,o=(c=e.calendarChannels[0])==null?void 0:c.syncStatus,r=We(n,o);return d(Xe,{children:[r===l.FAILED&&t(O,{color:"red",text:E._({id:"5TRY4+"}),weight:"medium"}),r===l.SYNCED&&t(O,{color:"green",text:E._({id:"N2FcBE"}),weight:"medium"}),r===l.NOT_SYNCED&&t(O,{color:"orange",text:E._({id:"hZWthZ"}),weight:"medium"}),r===l.IMPORTING&&t(O,{color:"turquoise",text:E._({id:"RqSvT0"}),weight:"medium",isLoaderVisible:!0}),t(Ze,{account:e})]})},Je=e=>{var _,I,a;const n=P(),{account:o}=e,r=R((_=o.connectionParameters)==null?void 0:_.IMAP),i=R((I=o.connectionParameters)==null?void 0:I.SMTP),c=R((a=o.connectionParameters)==null?void 0:a.CALDAV);let s;return r&&i&&c?s=G:r&&c?s=G:r&&i?s=f:r?s=f:i?s=Ge:c?s=$:s=f,t(s,{className:e.className,style:e.style,size:e.size,stroke:e.stroke,color:e.color||n.font.color.primary})},et=e=>{switch(e.provider){case L.IMAP_SMTP_CALDAV:return n=>t(Je,{account:e,className:n.className,style:n.style,size:n.size,stroke:n.stroke,color:n.color});case L.GOOGLE:return Le;case L.MICROSOFT:return Re;default:return f}},tt=({account:e})=>et(e),ot=m.div`
  align-items: center;
  color: ${({theme:e})=>e.font.color.primary};
  display: flex;
  gap: ${({theme:e})=>e.spacing(1)};
`,nt=m(x)`
  &:hover {
    background: ${({theme:e})=>e.background.transparent.light};
    cursor: pointer;
  }
`,it=({account:e})=>{const n=P(),o=tt({account:e});return d(nt,{gridAutoColumns:"332px 1fr",children:[t(C,{children:d(ot,{children:[t(o,{size:n.icon.size.md,stroke:n.icon.stroke.sm}),e.handle]})}),t(C,{align:"right",children:t(Qe,{account:e})})]},e.id)},st=m.div`
  padding-bottom: ${({theme:e})=>e.spacing(2)};
  padding-top: ${({theme:e})=>e.spacing(2)};
`,rt=m(D)`
  border-top: 1px solid ${({theme:e})=>e.border.color.light};
  display: flex;
  justify-content: flex-end;
  padding-top: ${({theme:e})=>e.spacing(2)};
  padding-bottom: ${({theme:e})=>e.spacing(2)};
`,ct=({accounts:e})=>{const{i18n:n,_:o}=T(),r=Q();return e.length?d(D,{children:[d(B,{children:[t(Ke,{}),t(st,{children:e.map(i=>t(it,{account:i},i.id))})]}),t(rt,{children:t(K,{Icon:be,title:n._({id:"MPPZ54"}),variant:"secondary",size:"small",onClick:()=>r(u.NewAccount)})})]}):t(ye,{})},dt=m.div`
  display: flex;
  gap: ${({theme:e})=>e.spacing(4)};
  margin-top: ${({theme:e})=>e.spacing(6)};

  @media (max-width: ${Pe}pxF) {
    flex-direction: column;
  }
`,at=()=>{const{i18n:e,_:n}=T(),o=P();return d(D,{children:[t(v,{title:e._({id:"Tz0i8g"}),description:e._({id:"Bh4GBD"})}),d(dt,{children:[t(z,{to:k(u.AccountsEmails),children:t(j,{Icon:t(ke,{size:o.icon.size.lg,stroke:o.icon.stroke.sm}),title:e._({id:"BXEcos"}),description:e._({id:"V7fgiB"})})}),t(z,{to:k(u.AccountsCalendars),children:t(j,{Icon:t($,{size:o.icon.size.lg,stroke:o.icon.stroke.sm}),title:e._({id:"AjVXBS"}),description:e._({id:"QTNsSm"})})})]})]})},ft=()=>{const{i18n:e,_:n}=T(),o=Z(W),{objectMetadataItem:r}=xe({objectNameSingular:S.ConnectedAccount}),{records:i,loading:c}=X({objectNameSingular:S.ConnectedAccount,filter:{accountOwnerId:{eq:o==null?void 0:o.id}},recordGqlFields:we({objectMetadataItem:r})});return t(ve,{title:e._({id:"AeXO77"}),links:[{children:e._({id:"7PzzBU"}),href:k(u.ProfilePage)},{children:e._({id:"AeXO77"})}],children:t(Me,{children:c?t($e,{}):d(M,{children:[d(D,{children:[t(v,{title:e._({id:"9TzudL"}),description:e._({id:"FyFNsd"})}),t(ct,{accounts:i})]}),t(qe,{}),t(at,{})]})})})};export{ft as SettingsAccounts};
