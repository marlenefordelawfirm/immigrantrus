import{fd as te,b6 as L,fe as ne,a6 as p,eH as q,o as E,j as t,dA as N,a as u,eJ as R,bx as K,dB as U,d9 as H,eK as z,dz as J,ff as $,i as I,a0 as Q,n as h,N as oe,R as w,fg as ie,B as _,bz as M,be as C,fh as se,z as x,eX as re,av as X,ax as ae,bA as B,h as g,ad as A,ai as P,fi as de,w as ce,F as le,L as O,x as ue,C as V,y as pe,c8 as ve,aj as Se,fj as ge,fk as he,b2 as me,r as ye,fl as fe,fm as Ie,A as we,fn as _e,bF as Ae,H as D,aL as Pe,db as Ee,l as F,Z as G}from"./index.Dg3lKJeg.js";import{S as Ce}from"./SettingsPageContainer.CJeLyK8s.js";import{S as Y}from"./SettingsCard.EuecTdsf.js";import{S as W}from"./SettingsListCard.8D1EoUNq.js";import{S as b}from"./SSOIdentitiesProvidersState.BmKplu8q.js";import{I as be}from"./IconArchive.Cju1PHwh.js";import{S as y}from"./SettingsOptionCardContentToggle.DYPf28jM.js";import{I as Z,a as ke}from"./IconPassword.sQ2GfeII.js";import{I as De}from"./IconLink.CigATr5g.js";import{I as Oe}from"./IconMailCog.D1zKcq18.js";import{S as xe}from"./SubMenuTopBarContainer.BNGFwgBo.js";import"./SettingsOptionIconCustomizer.BYkiWDDL.js";import"./Breadcrumb.CQyf5Hn6.js";/* @license Enterprise */const Le=()=>{const[e]=te(),o=L(b);return{deleteSSOIdentityProvider:async({identityProviderId:d})=>await e({variables:{input:{identityProviderId:d}},onCompleted:a=>{o(n=>n.filter(s=>s.id!==a.deleteSSOIdentityProvider.identityProviderId))}})}};/* @license Enterprise */const Me=()=>{const[e]=ne(),o=L(b);return{updateSSOIdentityProvider:async d=>await e({variables:{input:d},onCompleted:a=>{o(n=>n.map(s=>s.id===a.editSSOIdentityProvider.id?a.editSSOIdentityProvider:s))}})}},Re=({SSOIdp:e})=>{const o=`settings-account-row-${e.id}`,{enqueueErrorSnackBar:i}=p(),{closeDropdown:d}=q(),{deleteSSOIdentityProvider:a}=Le(),{updateSSOIdentityProvider:n}=Me(),{i18n:s,_:c}=E(),r=async S=>{const f=await a({identityProviderId:S});I(f.errors)&&i({message:s._({id:"cyvTSq"}),options:{duration:2e3}})},v=async S=>{const f=await n({id:S,status:e.status==="Active"?$.Inactive:$.Active});I(f.errors)&&i({message:s._({id:"WEltn2"}),options:{duration:2e3}})};return t(J,{dropdownId:o,dropdownPlacement:"right-start",clickableComponent:t(H,{Icon:z,accent:"tertiary"}),dropdownComponents:t(N,{children:u(U,{children:[t(R,{accent:"default",LeftIcon:be,text:e.status==="Active"?s._({id:"5y3O+A"}):s._({id:"FQBaXG"}),onClick:()=>{v(e.id),d(o)}}),t(R,{accent:"danger",LeftIcon:K,text:s._({id:"cnGeoo"}),onClick:()=>{r(e.id),d(o)}})]})})})},Fe={Active:"green",Inactive:"gray",Error:"red"};/* @license Enterprise */const Be=h.div`
  align-items: center;
  display: flex;
  gap: ${({theme:e})=>e.spacing(1)};
`,Te=({SSOIdp:e})=>u(Be,{children:[t(Q,{color:Fe[e.status],text:e.status,weight:"medium"}),t(Re,{SSOIdp:e})]});/* @license Enterprise */const $e=()=>{const e=oe(),o=w(b);return t(W,{items:o,getItemLabel:i=>`${i.name} - ${i.type}`,RowIconFn:i=>ie(i.issuer),RowRightComponent:({item:i})=>t(Te,{SSOIdp:i}),hasFooter:!0,footerButtonLabel:"Add SSO Identity Provider",onFooterButtonClick:()=>e(_.NewSSOIdentityProvider)})};/* @license Enterprise */const Ve=h(X,{shouldForwardProp:e=>ae(e)&&e!=="isDisabled"})`
  pointer-events: ${({isDisabled:e})=>e?"none":"auto"};
  text-decoration: none;
`,Ge=()=>{const{enqueueErrorSnackBar:e}=p(),o=w(M),{i18n:i,_:d}=E(),[a,n]=C(b),{loading:s}=se({fetchPolicy:"network-only",skip:(o==null?void 0:o.hasValidEnterpriseKey)===!1,onCompleted:c=>{n((c==null?void 0:c.getSSOIdentityProviders)??[])},onError:c=>{e({apolloError:c})}});return s||!a.length?t(Ve,{to:x(_.NewSSOIdentityProvider),isDisabled:(o==null?void 0:o.hasValidEnterpriseKey)!==!0,children:t(Y,{title:i._({id:"sgXUv+"}),disabled:(o==null?void 0:o.hasValidEnterpriseKey)!==!0,Icon:t(re,{})})}):t($e,{})},je=()=>{const{enqueueErrorSnackBar:e}=p(),[o,i]=C(M),[d]=B(),a=async()=>{if(!(o!=null&&o.id))throw new Error("User is not logged in");const n=!o.isTwoFactorAuthenticationEnforced;try{i({...o,isTwoFactorAuthenticationEnforced:n}),await d({variables:{input:{isTwoFactorAuthenticationEnforced:n}}})}catch(s){i({...o,isTwoFactorAuthenticationEnforced:!n}),e({apolloError:s instanceof P?s:void 0,message:s==null?void 0:s.message})}};return t(A,{children:o&&t(y,{Icon:Z,title:g._({id:"tuvLv1"}),description:g._({id:"Vv4JVS"}),checked:o.isTwoFactorAuthenticationEnforced,onChange:a,advancedMode:!0})})},qe=h.div`
  display: flex;
  flex-direction: column;
  gap: ${({theme:e})=>e.spacing(4)};
`,Ne=()=>{const{i18n:e,_:o}=E(),{enqueueErrorSnackBar:i}=p(),d=w(b),a=w(de),[n,s]=C(M),c=ce(le.IS_TWO_FACTOR_AUTHENTICATION_ENABLED),[r]=B(),v=m=>n?Reflect.has(n,m):!1,S=async m=>{if(!(n!=null&&n.id))throw new Error(e._({id:"IjyOjp"}));const l=`is${ve(m)}AuthEnabled`;if(!v(l))throw new Error(e._({id:"NtFk/Z"}));const ee=[n.isGoogleAuthEnabled,n.isMicrosoftAuthEnabled,n.isPasswordAuthEnabled,((d==null?void 0:d.length)??0)>0];if(n[l]===!0&&ee.filter(k=>k).length<=1)return i({message:e._({id:"Y7Dx6e"})});s({...n,[l]:!n[l]}),r({variables:{input:{[l]:!n[l]}}}).catch(k=>{s({...n,[l]:!n[l]}),i({apolloError:k instanceof P?k:void 0})})},f=async m=>{try{if(!(n!=null&&n.id))throw new Error(e._({id:"IjyOjp"}));await r({variables:{input:{isPublicInviteLinkEnabled:m}}}),s({...n,isPublicInviteLinkEnabled:m})}catch(l){i({apolloError:l instanceof P?l:void 0})}};return t(qe,{children:n&&u(A,{children:[u(O,{rounded:!0,children:[a.google===!0&&t(y,{Icon:ue,title:"Google",description:e._({id:"GMx1K0"}),checked:n.isGoogleAuthEnabled,advancedMode:!0,divider:!0,onChange:()=>S(V.GOOGLE)}),a.microsoft===!0&&t(y,{Icon:pe,title:"Microsoft",description:e._({id:"dea+zy"}),checked:n.isMicrosoftAuthEnabled,advancedMode:!0,divider:!0,onChange:()=>S(V.MICROSOFT)}),a.password===!0&&t(y,{Icon:ke,title:e._({id:"8ZsakT"}),description:e._({id:"vHeVg5"}),checked:n.isPasswordAuthEnabled,advancedMode:!0,onChange:()=>S("password")})]}),t(O,{rounded:!0,children:t(y,{Icon:De,title:e._({id:"3athPG"}),description:e._({id:"wMg43c"}),checked:n.isPublicInviteLinkEnabled,advancedMode:!0,onChange:()=>f(!n.isPublicInviteLinkEnabled)})}),c&&t(O,{rounded:!0,children:t(je,{})})]})})},T=Se({key:"ApprovedAccessDomainsState",defaultValue:[]}),Ke=({approvedAccessDomain:e})=>{const o=`settings-approved-access-domain-row-${e.id}`,i=L(T),{enqueueErrorSnackBar:d}=p(),{closeDropdown:a}=q(),[n]=ge(),s=async()=>{const c=await n({variables:{input:{id:e.id}},onCompleted:()=>{i(r=>r.filter(({id:v})=>v!==e.id))}});I(c.errors)&&d({message:g._({id:"VVRHmR"}),options:{duration:2e3}})};return t(J,{dropdownId:o,dropdownPlacement:"right-start",clickableComponent:t(H,{Icon:z,accent:"tertiary"}),dropdownComponents:t(N,{children:t(U,{children:t(R,{accent:"danger",LeftIcon:K,text:"Delete",onClick:()=>{s(),a(o)}})})})})},Ue=()=>{const[e]=he(),{enqueueSuccessSnackBar:o,enqueueErrorSnackBar:i}=p(),[d]=me(),a=d.get("wtdId"),n=d.get("validationToken"),s=L(T);return ye.useEffect(()=>{I(n)&&I(a)&&e({variables:{input:{validationToken:n,approvedAccessDomainId:a}},onCompleted:()=>{s(c=>c.map(r=>({...r,isValidated:r.id===a?!0:r.isValidated}))),o({message:g._({id:"UDlRcx"}),options:{dedupeKey:"approved-access-domain-validation-dedupe-key"}})},onError:c=>{const r=c!=null&&c.message?c.message:"Error validating approved access domain";i({message:g._({id:"wapGcj",values:{message:r}}),options:{dedupeKey:"approved-access-domain-validation-error-dedupe-key"}})}})},[]),t(A,{})},He=h(X)`
  text-decoration: none;
`,ze=()=>{const{enqueueErrorSnackBar:e}=p(),o=fe(),{i18n:i,_:d}=E(),[a,n]=C(T),{loading:s}=Ie({fetchPolicy:"network-only",onCompleted:r=>{n((r==null?void 0:r.getApprovedAccessDomains)??[])},onError:r=>{e({apolloError:r instanceof P?r:void 0})}}),c=r=>{const v=_e(r);return i._({id:"jEHeq+",values:{beautifyPastDateRelative:v}})};return s||!a.length?t(He,{to:x(_.NewApprovedAccessDomain),children:t(Y,{title:i._({id:"HD0x5p"}),Icon:t(Oe,{})})}):u(A,{children:[t(Ue,{}),t(W,{items:a,getItemLabel:({domain:r})=>r,getItemDescription:({createdAt:r})=>c(r),RowIcon:we,RowRightComponent:({item:r})=>u(A,{children:[!r.isValidated&&t(Q,{color:"orange",text:"Pending"}),t(Ke,{approvedAccessDomain:r})]}),hasFooter:!0,footerButtonLabel:"Add Approved Access Domain",onFooterButtonClick:()=>o(x(_.NewApprovedAccessDomain))})]})},Je=()=>{const{enqueueErrorSnackBar:e}=p(),[o,i]=C(M),[d]=B(),a=async n=>{try{if(!(o!=null&&o.id))throw new Error("User is not logged in");await d({variables:{input:{allowImpersonation:n}}}),i({...o,allowImpersonation:n})}catch(s){e({apolloError:s instanceof P?s:void 0})}};return t(O,{rounded:!0,children:t(y,{Icon:Z,title:g._({id:"U6bnfj"}),description:g._({id:"6eo66Q"}),checked:(o==null?void 0:o.allowImpersonation)??!1,onChange:a,advancedMode:!0})})},Qe=h.div`
  width: 100%;
`,Xe=h.div`
  display: flex;
  flex-direction: column;
  gap: ${({theme:e})=>e.spacing(10)};
  min-height: 200px;
`,j=h(F)`
  flex-shrink: 0;
`,lt=()=>{const{i18n:e,_:o}=E(),i=w(Ae);return t(xe,{title:e._({id:"a3LDKx"}),links:[{children:t(G,{id:"pmUArF"}),href:x(_.Workspace)},{children:t(G,{id:"a3LDKx"})}],children:t(Ce,{children:u(Xe,{children:[u(j,{children:[t(D,{title:e._({id:"vnS6Rf"}),description:e._({id:"+zUMwJ"}),adornment:t(Pe,{text:e._({id:"GpB8YV"}),color:"transparent",Icon:Ee,variant:"border"})}),t(Ge,{})]}),u(j,{children:[t(D,{title:e._({id:"9tggYj"}),description:e._({id:"xJR+Wq"})}),t(ze,{})]}),t(F,{children:u(Qe,{children:[t(D,{title:e._({id:"P8fBlG"}),description:e._({id:"bCJa9l"})}),t(Ne,{})]})}),i&&u(F,{children:[t(D,{title:e._({id:"XYLcNv"}),description:e._({id:"49MfD1"})}),t(Je,{})]})]})})})};export{lt as SettingsSecurity};
