import{g as S,a as D,b as T,c as z,d as I,e as E,f as O,h as A,i as P}from"./syntax.Dh_7PnPp.js";import{f as g}from"./index.DdCAsX36.js";import{o as p}from"./default.Cl3hj7Sz.js";import{h as j}from"./index.DOWyBKr8.js";import"./index.c2V3InAJ.js";import"./index.BVeNH5zi.js";import"./index.ByI_odx6.js";import"./index.Wb4bzIyB.js";import"./index.COYepv-L.js";function h(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}C.peek=$;function V(){this.buffer()}function _(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function R(){this.buffer()}function B(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function G(t){const e=this.resume(),n=this.stack[this.stack.length-1];p(n.type==="footnoteReference"),n.identifier=h(this.sliceSerialize(t)).toLowerCase(),n.label=e}function U(t){this.exit(t)}function W(t){const e=this.resume(),n=this.stack[this.stack.length-1];p(n.type==="footnoteDefinition"),n.identifier=h(this.sliceSerialize(t)).toLowerCase(),n.label=e}function N(t){this.exit(t)}function $(){return"["}function C(t,e,n,i){const r=n.createTracker(i);let o=r.move("[^");const a=n.enter("footnoteReference"),s=n.enter("reference");return o+=r.move(n.safe(n.associationId(t),{after:"]",before:o})),s(),a(),o+=r.move("]"),o}function q(){return{enter:{gfmFootnoteCallString:V,gfmFootnoteCall:_,gfmFootnoteDefinitionLabelString:R,gfmFootnoteDefinition:B},exit:{gfmFootnoteCallString:G,gfmFootnoteCall:U,gfmFootnoteDefinitionLabelString:W,gfmFootnoteDefinition:N}}}function H(t){let e=!1;return t&&t.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:n,footnoteReference:C},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(i,r,o,a){const s=o.createTracker(a);let l=s.move("[^");const c=o.enter("footnoteDefinition"),m=o.enter("label");return l+=s.move(o.safe(o.associationId(i),{before:l,after:"]"})),m(),l+=s.move("]:"),i.children&&i.children.length>0&&(s.shift(4),l+=s.move((e?`
`:" ")+o.indentLines(o.containerFlow(i,s.current()),e?L:J))),c(),l}}function J(t,e,n){return e===0?t:L(t,e,n)}function L(t,e,n){return(n?"":"    ")+t}function K(){return{exit:{taskListCheckValueChecked:F,taskListCheckValueUnchecked:F,paragraph:X}}}function Q(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Y}}}function F(t){const e=this.stack[this.stack.length-2];p(e.type==="listItem"),e.checked=t.type==="taskListCheckValueChecked"}function X(t){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const n=this.stack[this.stack.length-1];p(n.type==="paragraph");const i=n.children[0];if(i&&i.type==="text"){const r=e.children;let o=-1,a;for(;++o<r.length;){const s=r[o];if(s.type==="paragraph"){a=s;break}}a===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(t)}function Y(t,e,n,i){const r=t.children[0],o=typeof t.checked=="boolean"&&r&&r.type==="paragraph",a="["+(t.checked?"x":" ")+"] ",s=n.createTracker(i);o&&s.move(a);let l=j.listItem(t,e,n,{...i,...s.current()});return o&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),l;function c(m){return m+a}}function Z(){return[S(),q(),D(),T(),K()]}function v(t){return{extensions:[z(),H(t),I(),E(t),Q()]}}function tt(t,e,n,i){const r=t.length;let o=0,a;if(e<0?e=-e>r?0:r+e:e=e>r?r:e,n=n>0?n:0,i.length<1e4)a=Array.from(i),a.unshift(e,n),t.splice(...a);else for(n&&t.splice(e,n);o<i.length;)a=i.slice(o,o+1e4),a.unshift(e,0),t.splice(...a),o+=1e4,e+=1e4}const x={}.hasOwnProperty;function nt(t){const e={};let n=-1;for(;++n<t.length;)et(e,t[n]);return e}function et(t,e){let n;for(n in e){const r=(x.call(t,n)?t[n]:void 0)||(t[n]={}),o=e[n];let a;if(o)for(a in o){x.call(r,a)||(r[a]=[]);const s=o[a];it(r[a],Array.isArray(s)?s:s?[s]:[])}}}function it(t,e){let n=-1;const i=[];for(;++n<e.length;)(e[n].add==="after"?t:i).push(e[n]);tt(t,0,0,i)}function d(t){return t!==null&&t<-2}function k(t){return t!==null&&(t<0||t===32)}function y(t){return t===-2||t===-1||t===32}const ot={partial:!0,tokenize:rt};function rt(t,e,n){return i;function i(o){return y(o)?g(t,r,"linePrefix")(o):r(o)}function r(o){return o===null||d(o)?e(o):n(o)}}const at={tokenize:ht,partial:!0};function lt(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:ct,continuation:{tokenize:mt},exit:kt}},text:{91:{name:"gfmFootnoteCall",tokenize:ft},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:st,resolveTo:ut}}}}function st(t,e,n){const i=this;let r=i.events.length;const o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a;for(;r--;){const l=i.events[r][1];if(l.type==="labelImage"){a=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return s;function s(l){if(!a||!a._balanced)return n(l);const c=h(i.sliceSerialize({start:a.end,end:i.now()}));return c.codePointAt(0)!==94||!o.includes(c.slice(1))?n(l):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(l),t.exit("gfmFootnoteCallLabelMarker"),e(l))}}function ut(t,e){let n=t.length;for(;n--;)if(t[n][1].type==="labelImage"&&t[n][0]==="enter"){t[n][1];break}t[n+1][1].type="data",t[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},t[n+3][1].start),end:Object.assign({},t[t.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},t[n+3][1].end),end:Object.assign({},t[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},t[t.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},s=[t[n+1],t[n+2],["enter",i,e],t[n+3],t[n+4],["enter",r,e],["exit",r,e],["enter",o,e],["enter",a,e],["exit",a,e],["exit",o,e],t[t.length-2],t[t.length-1],["exit",i,e]];return t.splice(n,t.length-n+1,...s),t}function ft(t,e,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o=0,a;return s;function s(f){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(f),t.exit("gfmFootnoteCallLabelMarker"),l}function l(f){return f!==94?n(f):(t.enter("gfmFootnoteCallMarker"),t.consume(f),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",c)}function c(f){if(o>999||f===93&&!a||f===null||f===91||k(f))return n(f);if(f===93){t.exit("chunkString");const b=t.exit("gfmFootnoteCallString");return r.includes(h(i.sliceSerialize(b)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(f),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),e):n(f)}return k(f)||(a=!0),o++,t.consume(f),f===92?m:c}function m(f){return f===91||f===92||f===93?(t.consume(f),o++,c):c(f)}}function ct(t,e,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o,a=0,s;return l;function l(u){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(u),t.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(u){return u===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(u),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",m):n(u)}function m(u){if(a>999||u===93&&!s||u===null||u===91||k(u))return n(u);if(u===93){t.exit("chunkString");const w=t.exit("gfmFootnoteDefinitionLabelString");return o=h(i.sliceSerialize(w)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(u),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),b}return k(u)||(s=!0),a++,t.consume(u),u===92?f:m}function f(u){return u===91||u===92||u===93?(t.consume(u),a++,m):m(u)}function b(u){return u===58?(t.enter("definitionMarker"),t.consume(u),t.exit("definitionMarker"),r.includes(o)||r.push(o),g(t,M,"gfmFootnoteDefinitionWhitespace")):n(u)}function M(u){return e(u)}}function mt(t,e,n){return t.check(ot,e,t.attempt(at,e,n))}function kt(t){t.exit("gfmFootnoteDefinition")}function ht(t,e,n){const i=this;return g(t,r,"gfmFootnoteDefinitionIndent",5);function r(o){const a=i.events[i.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?e(o):n(o)}}const gt={name:"tasklistCheck",tokenize:bt};function pt(){return{text:{91:gt}}}function bt(t,e,n){const i=this;return r;function r(l){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(l):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),o)}function o(l){return k(l)?(t.enter("taskListCheckValueUnchecked"),t.consume(l),t.exit("taskListCheckValueUnchecked"),a):l===88||l===120?(t.enter("taskListCheckValueChecked"),t.consume(l),t.exit("taskListCheckValueChecked"),a):n(l)}function a(l){return l===93?(t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),s):n(l)}function s(l){return d(l)?e(l):y(l)?t.check({tokenize:Ft},e,n)(l):n(l)}}function Ft(t,e,n){return g(t,i,"whitespace");function i(r){return r===null?n(r):e(r)}}function xt(t){return nt([O(),lt(),A(t),P(),pt()])}const Ct={};function It(t){const e=this,n=t||Ct,i=e.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),o=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(xt(n)),o.push(Z()),a.push(v(n))}export{It as default};
