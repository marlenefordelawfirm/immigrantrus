function A(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?y(e.position):"start"in e||"end"in e?y(e):"line"in e||"column"in e?g(e):""}function g(e){return w(e&&e.line)+":"+w(e&&e.column)}function y(e){return g(e&&e.start)+"-"+g(e&&e.end)}function w(e){return e&&typeof e=="number"?e:1}class d extends Error{constructor(t,n,o){super(),typeof n=="string"&&(o=n,n=void 0);let s="",i={},r=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof t=="string"?s=t:!i.cause&&t&&(r=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof o=="string"){const l=o.indexOf(":");l===-1?i.ruleId=o:(i.source=o.slice(0,l),i.ruleId=o.slice(l+1))}if(!i.place&&i.ancestors&&i.ancestors){const l=i.ancestors[i.ancestors.length-1];l&&(i.place=l.position)}const f=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=f?f.line:void 0,this.name=A(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=r&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}d.prototype.file="";d.prototype.name="";d.prototype.reason="";d.prototype.message="";d.prototype.stack="";d.prototype.column=void 0;d.prototype.line=void 0;d.prototype.ancestors=void 0;d.prototype.cause=void 0;d.prototype.fatal=void 0;d.prototype.place=void 0;d.prototype.ruleId=void 0;d.prototype.source=void 0;const c={basename:E,dirname:x,extname:I,join:L,sep:"/"};function E(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');h(e);let n=0,o=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1);return o<0?"":e.slice(n,o)}if(t===e)return"";let r=-1,f=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1),f>-1&&(e.codePointAt(s)===t.codePointAt(f--)?f<0&&(o=s):(f=-1,o=r));return n===o?o=r:o<0&&(o=e.length),e.slice(n,o)}function x(e){if(h(e),e.length===0)return".";let t=-1,n=e.length,o;for(;--n;)if(e.codePointAt(n)===47){if(o){t=n;break}}else o||(o=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function I(e){h(e);let t=e.length,n=-1,o=0,s=-1,i=0,r;for(;t--;){const f=e.codePointAt(t);if(f===47){if(r){o=t+1;break}continue}n<0&&(r=!0,n=t+1),f===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===o+1?"":e.slice(s,n)}function L(...e){let t=-1,n;for(;++t<e.length;)h(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":R(n)}function R(e){h(e);const t=e.codePointAt(0)===47;let n=S(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function S(e,t){let n="",o=0,s=-1,i=0,r=-1,f,l;for(;++r<=e.length;){if(r<e.length)f=e.codePointAt(r);else{if(f===47)break;f=47}if(f===47){if(!(s===r-1||i===1))if(s!==r-1&&i===2){if(n.length<2||o!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",o=0):(n=n.slice(0,l),o=n.length-1-n.lastIndexOf("/")),s=r,i=0;continue}}else if(n.length>0){n="",o=0,s=r,i=0;continue}}t&&(n=n.length>0?n+"/..":"..",o=2)}else n.length>0?n+="/"+e.slice(s+1,r):n=e.slice(s+1,r),o=r-s-1;s=r,i=0}else f===46&&i>-1?i++:i=-1}return n}function h(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const _={cwd:T};function T(){return"/"}function p(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function j(e){if(typeof e=="string")e=new URL(e);else if(!p(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return k(e)}function k(e){if(e.hostname!==""){const o=new TypeError('File URL host must be "localhost" or empty on darwin');throw o.code="ERR_INVALID_FILE_URL_HOST",o}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const o=t.codePointAt(n+2);if(o===70||o===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const u=["history","path","basename","stem","extname","dirname"];class D{constructor(t){let n;t?p(t)?n={path:t}:typeof t=="string"||N(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":_.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let o=-1;for(;++o<u.length;){const i=u[o];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)u.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?c.basename(this.path):void 0}set basename(t){m(t,"basename"),a(t,"basename"),this.path=c.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?c.dirname(this.path):void 0}set dirname(t){b(this.basename,"dirname"),this.path=c.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?c.extname(this.path):void 0}set extname(t){if(a(t,"extname"),b(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=c.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){p(t)&&(t=j(t)),m(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?c.basename(this.path,this.extname):void 0}set stem(t){m(t,"stem"),a(t,"stem"),this.path=c.join(this.dirname||"",t+(this.extname||""))}fail(t,n,o){const s=this.message(t,n,o);throw s.fatal=!0,s}info(t,n,o){const s=this.message(t,n,o);return s.fatal=void 0,s}message(t,n,o){const s=new d(t,n,o);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function a(e,t){if(e&&e.includes(c.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+c.sep+"`")}function m(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function b(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function N(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}export{d as V,D as a};
